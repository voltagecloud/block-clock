<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + Lit + TS</title>
    <script type="module" src="/src/index.ts"></script>
    <style>
      body {
        margin: 0;
        display: flex;
        justify-content: center;
        place-items: center;
        min-height: 100vh;
        background-color: black;
      }
    </style>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const blockClock = document.querySelector("block-clock");
        if (blockClock) {
          blockClock.setAttribute("fetch", async (method, params) => {
            const fetchMethod = "POST";
            const url = "https://bitcoind-prune1100.m.staging.voltageapp.io";
            const body = {
              jsonrpc: "1.0",
              method,
              params,
            };
            const init = {
              method: method,
              body: JSON.stringify(body),
            };
            let headers = {
              "Content-Type": "text/plain",
              Authorization: `Basic ${btoa("frontend:quintet-chill-palatable-figment")}`,
            };
            const result = await window.fetch(url, { ...init, headers });
            if (!result.ok) {
              throw new Error(
                result.statusText || `${method} ðŸ˜± ${result.status}`
              );
            }
            const data = await result.json().catch();
            if (data.error) {
              throw new Error(
                `Error ${data.error.code}: ${data.error.message}`
              );
            }
            return data.result;
          });
        }
      });
    </script>
  </head>
  <body>
    <div style="width: 200px; height: 200px">
      <block-clock darkMode> </block-clock>
    </div>
  </body>
</html>
